import{S as Z,i as j,s as v,F as $,W as c}from"../../../../chunks/vendor-64f33e0e.js";const J=1,K=5,tt=2;class et{constructor(a,s,i,t,n){this.items=a,this.radiusFun=s,this.xFun=i,this.padding=t,this.yOffset=n,this.tieBreakFn=this._sfc32(2654435769,608135816,3084996962,J),this.maxR=Math.max(...a.map(r=>s(r))),this.rng=this._sfc32(1,2,3,J)}calculateYPositions(){let a=this.items.map((t,n)=>({datum:t,originalIndex:n,x:this.xFun(t),r:this.radiusFun(t)+this.padding,y:null,placed:!1})).sort((t,n)=>t.x-n.x);a.forEach(function(t,n){t.index=n});let s=this.tieBreakFn;a.forEach(function(t){t.tieBreaker=s(t.x)});let i=[...a].sort((t,n)=>{let r=this.radiusFun(t.datum)+t.tieBreaker*K,d=this.radiusFun(n.datum)+n.tieBreaker*K;return r!=d?d-r:t.x-n.x});for(let t of i)t.placed=!0,t.y=this._getBestYPosition(t,a);return a.sort((t,n)=>t.originalIndex-n.originalIndex),a.map(t=>({x:t.x,y:t.y+this.yOffset,r:this.radiusFun(t.datum)}))}_sfc32(a,s,i,t){let n=function(){a>>>=0,s>>>=0,i>>>=0,t>>>=0;var r=a+s|0;return a=s^s>>>9,s=i+(i<<3)|0,i=i<<21|i>>>11,t=t+1|0,r=r+t|0,i=i+r|0,(r>>>0)/4294967296};for(let r=0;r<10;r++)n();return n}_getBestYPosition(a,s){let i=[];for(let n of[-1,1]){let r,d=a.r;for(let p=a.index+n;p>=0&&p<s.length&&(r=Math.abs(a.x-s[p].x))<d+this.maxR;p+=n){let x=s[p];if(!x.placed)continue;let m=d+x.r;if(r>=d+x.r)continue;let w=Math.sqrt(m*m-r*r),b=[x.y-w,x.y+w];i.push(b)}}if(i.length==0)return a.r*(this.rng()-.5)*tt;let t=i.flat();t.push(0),t.sort((n,r)=>{let d=Math.abs(n),p=Math.abs(r);return d<p?-1:d>p?1:n-r});for(let n=0;n<t.length;n++){let r=t[n];if(i.every(d=>r<=d[0]||r>=d[1]))return r}}}function rt(h,a,s){let i,t,n,r,d,p,x,m,w,b,S,k,R;const{data:G,x:P,y:C,r:I,xGet:E,yGet:Y,rGet:O,xScale:q,yScale:A,yRange:D,rRange:W,custom:L,width:V}=$("LayerCake");c(h,G,e=>s(18,R=e)),c(h,P,e=>s(16,S=e)),c(h,C,e=>s(15,b=e)),c(h,I,e=>s(14,w=e)),c(h,E,e=>s(23,r=e)),c(h,Y,e=>s(26,x=e)),c(h,O,e=>s(25,p=e)),c(h,q,e=>s(21,t=e)),c(h,A,e=>s(20,i=e)),c(h,D,e=>s(22,n=e)),c(h,W,e=>s(24,d=e)),c(h,L,e=>s(17,k=e)),c(h,V,e=>s(13,m=e));let N=k.coords,_=k.type,z=m;function Q(e,F,f,y,T,H){let u=F.mode,U=F.padding,X=F.animation&&H==z?F.duration:0;z=H;let B;if(_=="bar")B=e.map((g,o)=>g.map((l,M)=>({x:u=="default"||u=="grouped"||(u=="comparison"||u=="stacked")&&o==0?0:u=="stacked"?f(e[o-1][M]):f(l),y:u=="grouped"?x(l)+o*(1/e.length)*i.bandwidth():x(l),w:u=="default"||u=="grouped"||(u=="comparison"||u=="stacked")&&o==0?f(l):u=="stacked"?f(l)-f(e[o-1][M]):0,h:u=="grouped"?i.bandwidth()/e.length:i.bandwidth()})));else if(_=="column")B=e.map((g,o)=>g.map((l,M)=>({x:u=="grouped"&&t.bandwidth?r(l)+o*(1/e.length)*t.bandwidth():u=="grouped"?r(l)[0]+o*(1/e.length)*Math.max(0,r(l)[1]-r(l)[0]):t.bandwidth?r(l):r(l)[0],y:y(l),w:u=="grouped"&&t.bandwidth?t.bandwidth()/e.length:u=="grouped"?Math.max(0,r(l)[1]-r(l)[0])/e.length:t.bandwidth?t.bandwidth():Math.max(0,r(l)[1]-r(l)[0]),h:u=="default"||u=="grouped"||(u=="comparison"||u=="stacked")&&o==0?y(l):u=="stacked"?y(l)-y(e[o-1][M]):0})));else if(_=="scatter"){let g=o=>T?p(o):d[0];B=y?e.map(o=>({x:f(o),y:y(o),r:g(o)})):new et(e,o=>g(o),o=>r(o),U,n[0]/2).calculateYPositions().map(o=>({x:t.invert(o.x),y:i.invert(o.y),r:o.r}))}else _=="line"&&(B=e.map(g=>g.map(o=>({x:f(o),y:y(o)}))));N.set(B,{duration:X})}return h.$$.update=()=>{h.$$.dirty&516096&&Q(R,k,S,b,w,m)},[G,P,C,I,E,Y,O,q,A,D,W,L,V,m,w,b,S,k,R]}class st extends Z{constructor(a){super();j(this,a,rt,null,v,{})}}export{st as default};
